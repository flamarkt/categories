{"version":3,"file":"backoffice.js","mappings":"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","sources":["webpack://@flamarkt/categories/webpack/bootstrap","webpack://@flamarkt/categories/webpack/runtime/compat get default export","webpack://@flamarkt/categories/webpack/runtime/define property getters","webpack://@flamarkt/categories/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/categories/webpack/runtime/make namespace object","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/BackofficeNav']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/ActiveLinkButton']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/categories/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/categories/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/categories/./src/common/models/Category.ts","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['states/AbstractListState']\"","webpack://@flamarkt/categories/./src/backoffice/states/CategoryListState.ts","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/AbstractList']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flamarkt/categories/./src/backoffice/components/CategoryList.ts","webpack://@flamarkt/categories/./src/backoffice/pages/CategoryIndexPage.ts","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SubmitButton']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SoftDeleteButton']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/PermanentDeleteButton']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/AbstractRelationshipSelect']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flamarkt/categories/./src/backoffice/components/CategoryRelationshipSelect.ts","webpack://@flamarkt/categories/./src/backoffice/pages/CategoryShowPage.ts","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['components/ProductList']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['pages/ProductShowPage']\"","webpack://@flamarkt/categories/./src/backoffice/index.ts","webpack://@flamarkt/categories/./src/backoffice/extendProductIndex.ts","webpack://@flamarkt/categories/./src/backoffice/extendProductShow.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/BackofficeNav'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/ActiveLinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Model from 'flarum/common/Model';\n\nexport default class Category extends Model {\n    slug = Model.attribute<string>('slug');\n    title = Model.attribute<string>('title');\n    description = Model.attribute<string>('description');\n    productCount = Model.attribute<number>('productCount');\n    isHidden = Model.attribute<boolean>('isHidden');\n\n    parent = Model.hasOne<Category>('parent');\n\n    apiEndpoint() {\n        return '/flamarkt/categories' + (this.exists ? '/' + (this.data as any).id : '');\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['states/AbstractListState'];","import AbstractListState from 'flamarkt/backoffice/common/states/AbstractListState';\nimport Category from '../../common/models/Category';\n\nexport default class CategoryListState extends AbstractListState<Category> {\n    type() {\n        return 'flamarkt/categories';\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/AbstractList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","import AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport Link from 'flarum/common/components/Link';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Category from '../../common/models/Category';\n\nexport default class CategoryList extends AbstractList<Category> {\n    head() {\n        const columns = super.head();\n\n        columns.add('parent', m('th', 'Parent'));\n        columns.add('title', m('th', 'Title'));//TODO\n        columns.add('productCount', m('th', 'Products'));\n\n        return columns;\n    }\n\n    columns(category: Category) {\n        const columns = super.columns(category);\n\n        const parent = category.parent();\n\n        columns.add('parent', m('td', parent ? m(Link, {\n            href: app.route('categories.show', {\n                id: parent.id(),\n            }),\n        }, parent.title()) : m('em', 'Root')));\n        columns.add('title', m('td', category.title()));\n        columns.add('productCount', m('td', category.productCount()));\n\n        return columns;\n    }\n\n    actions(category: Category) {\n        const actions = super.actions(category);\n\n        actions.add('edit', LinkButton.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            href: app.route('categories.show', {\n                id: category.id(),\n            }),\n        }));\n\n        return actions;\n    }\n}\n","import {Vnode} from 'mithril';\nimport Page from 'flarum/common/components/Page';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport CategoryListState from '../states/CategoryListState';\nimport CategoryList from '../components/CategoryList';\n\nexport default class CategoryIndexPage extends Page {\n    categoryState!: CategoryListState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.categoryState = new CategoryListState();\n        this.categoryState.refresh();\n    }\n\n    view() {\n        return m('.ProductIndexPage', m('.container', [\n            m('.Form-group', [\n                LinkButton.component({\n                    className: 'Button',\n                    href: app.route('categories.show', {\n                        id: 'new',\n                    }),\n                }, 'New category' /* TODO */),\n            ]),\n            m(CategoryList, {\n                state: this.categoryState,\n            }),\n        ]));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SubmitButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SoftDeleteButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/PermanentDeleteButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/AbstractRelationshipSelect'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","import AbstractRelationshipSelect from 'flamarkt/backoffice/common/components/AbstractRelationshipSelect';\nimport highlight from 'flarum/common/helpers/highlight';\nimport Category from '../../common/models/Category';\n\nexport default class CategoryRelationshipSelect extends AbstractRelationshipSelect<Category> {\n    protected resultsCache = new Map<string, Category[]>();\n\n    search(query: string) {\n        if (!query) {\n            m.redraw();\n            return Promise.resolve();\n        }\n\n        query = query.toLowerCase();\n\n        return app.store\n            .find('flamarkt/categories', {\n                filter: {q: query},\n                page: {limit: 5},\n            })\n            .then((results) => {\n                this.resultsCache.set(query, results);\n                m.redraw();\n            });\n    }\n\n    results(query: string) {\n        if (!query) {\n            return [];\n        }\n\n        query = query.toLowerCase();\n\n        const results = this.resultsCache.get(query);\n\n        // Indicates still loading\n        if (typeof results === 'undefined') {\n            return null;\n        }\n\n        return results || [];\n    }\n\n    item(category: Category, query?: string) {\n        return [\n            query ? highlight(category.title(), query) : category.title(),\n        ];\n    }\n}\n","import {Children} from 'mithril';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport SoftDeleteButton from 'flamarkt/backoffice/backoffice/components/SoftDeleteButton';\nimport PermanentDeleteButton from 'flamarkt/backoffice/backoffice/components/PermanentDeleteButton';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Category from '../../common/models/Category';\nimport CategoryRelationshipSelect from '../components/CategoryRelationshipSelect';\n\nexport default class CategoryShowPage extends AbstractShowPage {\n    category: Category | null = null;\n    saving: boolean = false;\n    dirty: boolean = false;\n    parent: Category | null = null;\n    slug: string = '';\n    title: string = '';\n    description: string = '';\n\n    newRecord() {\n        return app.store.createRecord('flamarkt-categories');\n    }\n\n    findType() {\n        return 'flamarkt/categories';\n    }\n\n    show(category: Category) {\n        this.category = category;\n        this.parent = category.parent() || null;\n        this.slug = category.slug() || '';\n        this.title = category.title() || '';\n        this.description = category.description() || '';\n\n        app.setTitle(category.title());\n        app.setTitleCount(0);\n    }\n\n    view() {\n        if (!this.category) {\n            return LoadingIndicator.component();\n        }\n\n        return m('form.CategoryShowPage', {\n            onsubmit: this.onsubmit.bind(this),\n        }, m('.container.container--narrow', this.fields().toArray()));\n    }\n\n    fields(): ItemList<Children> {\n        const fields = new ItemList<Children>();\n\n        fields.add('parent', m('.Form-group', [\n            m('label', 'Parent'),\n            m(CategoryRelationshipSelect, {\n                relationship: this.parent,\n                onchange: (category: Category) => {\n                    this.parent = category;\n                    this.dirty = true;\n                },\n                hasOne: true,\n            }),\n        ]), 20);\n\n        fields.add('slug', m('.Form-group', [\n            m('label', 'Slug'),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.slug,\n                oninput: (event: Event) => {\n                    this.slug = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 20);\n\n        fields.add('title', m('.Form-group', [\n            m('label', 'Title'),\n            m('input.FormControl', {\n                type: 'text',\n                value: this.title,\n                oninput: (event: Event) => {\n                    this.title = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 20);\n\n        fields.add('description', m('.Form-group', [\n            m('label', 'Description'),\n            m('textarea.FormControl', {\n                value: this.description,\n                oninput: (event: Event) => {\n                    this.description = (event.target as HTMLInputElement).value;\n                    this.dirty = true;\n                },\n            }),\n        ]), 10);\n\n        fields.add('submit', m('.Form-group', [\n            SubmitButton.component({\n                loading: this.saving,\n                dirty: this.dirty,\n                exists: this.category!.exists,\n            }),\n            ' ',\n            SoftDeleteButton.component({\n                model: this.category,\n            }),\n            ' ',\n            PermanentDeleteButton.component({\n                model: this.category,\n                afterdelete() {\n                    m.route.set(app.route('categories.index'));\n                },\n            }),\n        ]));\n\n        return fields;\n    }\n\n    data() {\n        return {\n            slug: this.slug,\n            title: this.title,\n            description: this.description,\n            relationships: {\n                parent: this.parent,\n            },\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        this.category!.save(this.data()).then(category => {\n            this.category = category;\n\n            this.saving = false;\n            this.dirty = false;\n            m.redraw();\n\n            m.route.set(app.route.category(category));\n        }).catch(error => {\n            this.saving = false;\n            m.redraw();\n        });\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['components/ProductList'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['pages/ProductShowPage'];","import {extend} from 'flarum/common/extend';\nimport BackofficeNav from 'flamarkt/backoffice/backoffice/components/BackofficeNav';\nimport ActiveLinkButton from 'flamarkt/backoffice/common/components/ActiveLinkButton';\nimport Model from 'flarum/common/Model';\nimport Category from '../common/models/Category';\nimport CategoryIndexPage from './pages/CategoryIndexPage';\nimport CategoryShowPage from './pages/CategoryShowPage';\nimport extendProductIndex from './extendProductIndex';\nimport extendProductShow from './extendProductShow';\n\napp.initializers.add('flamarkt-categories', () => {\n    app.store.models['flamarkt-categories'] = Category;\n    app.store.models['flamarkt-products'].prototype.categories = Model.hasMany('categories');\n\n    app.routes['categories.index'] = {\n        path: '/categories',\n        component: CategoryIndexPage,\n    };\n    app.routes['categories.show'] = {\n        path: '/categories/:id',\n        component: CategoryShowPage,\n    };\n\n    app.route.category = category => {\n        return app.route('categories.show', {\n            id: category.id(),\n        });\n    };\n\n    extend(BackofficeNav.prototype, 'items', function (items) {\n        items.add('categories', ActiveLinkButton.component({\n            href: app.route('categories.index'),\n            icon: 'fas fa-th-list',\n            activeRoutes: [\n                'categories.*',\n            ],\n        }, app.translator.trans('flamarkt-categories.backoffice.nav.categories')));\n    });\n\n    extendProductIndex();\n    extendProductShow();\n});\n","import {extend} from 'flarum/common/extend';\nimport ProductList from 'flamarkt/core/backoffice/components/ProductList';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nexport default function () {\n    extend(ProductList.prototype, 'head', function (columns: ItemList) {\n        columns.add('categories', m('th', app.translator.trans('flamarkt-categories.backoffice.products.head.category')), 20);\n    });\n\n    extend(ProductList.prototype, 'columns', function (columns: ItemList, product) {\n        columns.add('categories', m('td', (product.categories() || []).map(category => category.title()).join(', ')), 20);\n    });\n}\n","import {extend} from 'flarum/common/extend';\nimport ProductShowPage from 'flamarkt/core/backoffice/pages/ProductShowPage';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport CategoryRelationshipSelect from './components/CategoryRelationshipSelect';\n\nexport default function () {\n    extend(ProductShowPage.prototype, 'oninit', function (this: ProductShowPage) {\n        this.categories = [];\n    });\n\n    extend(ProductShowPage.prototype, 'show', function (this: ProductShowPage, returnValue: any, product) {\n        this.categories = product.categories() || [];\n    });\n\n    extend(ProductShowPage.prototype, 'fields', function (this: ProductShowPage, fields: ItemList) {\n        fields.add('categories', m('.Form-group', [\n            m('label', 'Categories'),\n            m(CategoryRelationshipSelect, {\n                relationship: this.categories,\n                onchange: categories => {\n                    this.categories = categories;\n                    this.dirty = true;\n                },\n            }),\n        ]), 100);\n    });\n\n    extend(ProductShowPage.prototype, 'data', function (this: ProductShowPage, data: any) {\n        data.relationships = data.relationships || {};\n        data.relationships.categories = this.categories;\n    });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","extensions","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Category","slug","Model","title","description","productCount","isHidden","parent","apiEndpoint","this","exists","data","id","CategoryListState","type","AbstractListState","CategoryList","head","columns","add","m","category","Link","href","app","route","actions","LinkButton","className","icon","AbstractList","CategoryIndexPage","categoryState","oninit","vnode","refresh","view","state","Page","CategoryRelationshipSelect","resultsCache","Map","search","query","toLowerCase","store","find","filter","q","page","limit","then","results","set","redraw","Promise","resolve","item","highlight","AbstractRelationshipSelect","CategoryShowPage","saving","dirty","newRecord","createRecord","findType","show","setTitle","setTitleCount","onsubmit","fields","toArray","LoadingIndicator","ItemList","relationship","onchange","hasOne","oninput","event","target","SubmitButton","loading","SoftDeleteButton","model","PermanentDeleteButton","afterdelete","relationships","preventDefault","save","error","AbstractShowPage","initializers","models","categories","routes","path","component","extend","BackofficeNav","items","ActiveLinkButton","activeRoutes","translator","trans","ProductList","product","map","join","ProductShowPage","returnValue"],"sourceRoot":""}