{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flamarkt/categories/webpack/bootstrap","webpack://@flamarkt/categories/webpack/runtime/compat get default export","webpack://@flamarkt/categories/webpack/runtime/define property getters","webpack://@flamarkt/categories/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/categories/webpack/runtime/make namespace object","webpack://@flamarkt/categories/external root \"flarum.core.compat['forum/app']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/Separator']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@flamarkt/categories/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/categories/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/categories/./src/common/models/Category.ts","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/AbstractShopLayout']\"","webpack://@flamarkt/categories/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flamarkt/categories/./src/forum/layouts/CategoryIndexLayout.ts","webpack://@flamarkt/categories/./src/forum/pages/CategoryIndexPage.ts","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-core']||{})['common']||{})['states/ProductListState']\"","webpack://@flamarkt/categories/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/ProductIndexLayout']\"","webpack://@flamarkt/categories/./src/forum/layouts/CategoryShowLayout.ts","webpack://@flamarkt/categories/./src/forum/pages/CategoryShowPage.ts","webpack://@flamarkt/categories/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Separator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class Category extends Model {\n    slug = Model.attribute<string>('slug');\n    title = Model.attribute<string>('title');\n    description = Model.attribute<string>('description');\n    productCount = Model.attribute<number>('productCount');\n    isHidden = Model.attribute<boolean>('isHidden');\n\n    parent = Model.hasOne<Category>('parent');\n\n    apiEndpoint() {\n        return '/flamarkt/categories' + (this.exists ? '/' + (this.data as any).id : '');\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/AbstractShopLayout'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","import app from 'flarum/forum/app';\nimport AbstractShopLayout from 'flamarkt/core/forum/layouts/AbstractShopLayout';\nimport Link from 'flarum/common/components/Link';\nimport Category from '../../common/models/Category';\n\nexport default class CategoryIndexLayout extends AbstractShopLayout {\n    title() {\n        return app.translator.trans('flamarkt-categories.forum.categories.headingTitle');\n    }\n\n    content() {\n        const categories = app.store.all<Category>('flamarkt-categories');\n\n        return m('ul', categories.map(category => m('li', Link.component({\n            href: app.route.category(category),\n        }, category.title()))));\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport extractText from 'flarum/common/utils/extractText';\nimport CategoryIndexLayout from '../layouts/CategoryIndexLayout';\n\nexport default class CategoryIndexPage extends Page {\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        app.setTitle(extractText(app.translator.trans('flamarkt-categories.forum.categories.browserTitle')));\n        app.setTitleCount(0);\n    }\n\n    view() {\n        return CategoryIndexLayout.component();\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['common']||{})['states/ProductListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/ProductIndexLayout'];","import app from 'flarum/forum/app';\nimport ProductIndexLayout, {ProductIndexLayoutAttrs} from 'flamarkt/core/forum/layouts/ProductIndexLayout';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Category from '../../common/models/Category';\n\nexport interface CategoryShowLayoutAttrs extends ProductIndexLayoutAttrs {\n    category: Category | null,\n}\n\nexport default class CategoryShowLayout extends ProductIndexLayout<CategoryShowLayoutAttrs> {\n    attrs!: CategoryShowLayoutAttrs\n\n    breadcrumbItems() {\n        const items = super.breadcrumbItems();\n\n        items.add('categories', LinkButton.component({\n            href: app.route('flamarkt.categories.index'),\n        }, app.translator.trans('flamarkt-categories.forum.breadcrumb.categories')));\n\n        //TODO: parent category\n\n        return items;\n    }\n\n    title() {\n        if (!this.attrs.category) {\n            return app.translator.trans('flamarkt-categories.forum.category.titleWhileLoading');\n        }\n\n        return this.attrs.category.title();\n    }\n\n    currentPageHref() {\n        // We need to override this method because ProductIndexLayout uses it to signal whether it's the homepage\n        return '';\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flarum/forum/app';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport ProductListState from 'flamarkt/core/common/states/ProductListState';\nimport CategoryShowLayout from '../layouts/CategoryShowLayout';\nimport Category from '../../common/models/Category';\n\nexport default class CategoryShowPage extends AbstractShowPage {\n    category: Category | null = null;\n    listState!: ProductListState;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.listState = this.initState();\n    }\n\n    initState() {\n        const params = m.route.param();\n\n        return new ProductListState({\n            sort: params.sort,\n        });\n    }\n\n    findType() {\n        return 'flamarkt/categories';\n    }\n\n    requestParams(): any {\n        const params = super.requestParams();\n\n        params.bySlug = true;\n\n        return params;\n    }\n\n    show(category: Category) {\n        this.category = category;\n\n        app.setTitle(category.title());\n        app.setTitleCount(0);\n\n        this.listState.params.filter = {\n            category: category.slug(),\n        };\n        this.listState.refresh();\n    }\n\n    view() {\n        return CategoryShowLayout.component({\n            category: this.category,\n            state: this.listState,\n        });\n    }\n}\n","import app from 'flarum/forum/app';\nimport {extend} from 'flarum/common/extend';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Separator from 'flarum/common/components/Separator';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Category from '../common/models/Category';\nimport CategoryIndexPage from './pages/CategoryIndexPage';\nimport CategoryShowPage from './pages/CategoryShowPage';\n\napp.initializers.add('flamarkt-categories', () => {\n    app.store.models['flamarkt-categories'] = Category;\n\n    app.routes['flamarkt.categories.index'] = {\n        path: '/categories',\n        component: CategoryIndexPage,\n    };\n    app.routes['flamarkt.categories.show'] = {\n        path: '/categories/:id',\n        component: CategoryShowPage,\n    };\n\n    app.route.category = category => {\n        return app.route('flamarkt.categories.show', {\n            id: category.slug(),\n        });\n    };\n\n    extend(IndexPage.prototype, 'navItems', function (items) {\n        items.add('flamarkt-categories', LinkButton.component({\n            icon: 'fas fa-th-large',\n            href: app.route('flamarkt.categories.index'),\n        }, app.translator.trans('flamarkt-categories.forum.nav.allCategories')), -10);\n\n        if (app.current.matches(CategoryIndexPage)) return;\n\n        items.add('separator', Separator.component(), -12);\n\n        const categories = app.store.all<Category>('flamarkt-categories');\n\n        categories.forEach(category => {\n            items.add('flamarkt-category' + category.id(), LinkButton.component({\n                icon: 'fas fa-tag',\n                href: app.route.category(category),\n            }, [\n                category.title(),\n                m('span.Button-badge', category.productCount()),\n            ]), -14);\n        });\n    });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Category","slug","Model","title","description","productCount","isHidden","parent","apiEndpoint","this","exists","data","id","extensions","CategoryIndexLayout","app","content","categories","m","map","category","Link","href","AbstractShopLayout","CategoryIndexPage","oninit","vnode","extractText","view","component","Page","CategoryShowLayout","attrs","breadcrumbItems","items","add","LinkButton","currentPageHref","ProductIndexLayout","CategoryShowPage","listState","initState","params","route","param","ProductListState","sort","findType","requestParams","bySlug","show","filter","refresh","state","AbstractShowPage","path","extend","IndexPage","icon","Separator","forEach"],"sourceRoot":""}